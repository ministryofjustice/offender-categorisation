{% from "radios/macro.njk" import govukRadios %}
{% extends "../formTemplate.html" %}
{% from "warning-text/macro.njk" import govukWarningText %}
{% from "../../macros/renderAlert.html" import renderAlert %}


{% set greenButtonText = "Continue" %}
{% set backLink = "/recategoriserCheck" %}

{% block formItems %}

<h1 class="govuk-heading-l">Check change in risk status</h1>
<p>The following has flagged this person for early review</p>


{% if data.escapeList or data.escapeRisk or  data.escapeListAlert or data.escapeRiskAlert %}
<h2 class="govuk-heading-m">Risk of escape</h2>

{% if data.escapeList or data.escapeRisk %}
{{ govukWarningText({
  text: 'This person is now considered an escape risk',
  iconFallbackText: "Warning",
  classes: "forms-warning-text warning-overrides"
}) }}
{% endif %}

{% if data.escapeListAlert or data.escapeRiskAlert %}
<h2 class="govuk-heading-s">Previous Alert notes</h2>
<div class="govuk-details__text govuk-!-margin-bottom-3">
  {% for alert in data.oldProfile.escape.escapeListAlerts %}
  {{ renderAlert(alert) }}
  {% endfor %}
  {% for alert in data.oldProfile.escape.escapeRiskAlerts %}
  {{ renderAlert(alert) }}
  {% endfor %}
</div>
<h2 class="govuk-heading-s">Current Alert notes</h2>
<div class="govuk-details__text govuk-!-margin-bottom-3">
  {% for alert in data.newProfile.escape.escapeListAlerts %}
  {{ renderAlert(alert) }}
  {% endfor %}
  {% for alert in data.newProfile.escape.escapeRiskAlerts %}
  {{ renderAlert(alert) }}
  {% endfor %}
</div>
{% endif %}

{% endif %}

{% if data.increasedRiskOfExtremism or data.notifyRegionalCTLeadExtremism %}
<h2 class="govuk-heading-m">Extremism</h2>

{% if data.increasedRiskOfExtremism %}
 {{ govukWarningText({
      text: "This person is now at risk of engaging in, or vulnerable to, extremism",
      iconFallbackText: "Warning",
      classes: "forms-warning-text warning-overrides"
    }) }}
{% endif %}

{% if data.notifyRegionalCTLeadExtremism %}
 {{ govukWarningText({
      text: 'Please notify your regional CT lead that you have this person in custody',
      iconFallbackText: "Warning",
      classes: "forms-warning-text warning-overrides"
    }) }}
{% endif %}

{% endif %}

{% if data.violenceAssaultsChange  or data.violenceNotifySafetyCTLead %}
<h2 class="govuk-heading-m">Safety and good order</h2>

<h2 class="govuk-heading-s">Previous Safety and good order</h2>
{% if data.oldProfile.violence.displayAssaults %}
    {% set warningText %}
      This person has been reported as the perpetrator in {{ data.oldProfile.violence.numberOfAssaults }} assaults in custody before,
      including {{ data.oldProfile.violence.numberOfSeriousAssaults }} serious assaults in the last 12 months
    {% endset %}
    {{ govukWarningText({
      text: warningText,
      iconFallbackText: "Warning",
      classes: "forms-warning-text warning-overrides"
    }) }}
  {% endif %}
  {% if data.oldProfile.violence.notifySafetyCustodyLead %}
    {{ govukWarningText({
      text: 'Please notify your safer custody lead about this prisoner',
      iconFallbackText: "Warning",
      classes: "forms-warning-text warning-overrides"
    }) }}
 {% endif %}
<h2 class="govuk-heading-s">Current Safety and good order</h2>
{% if data.newProfile.violence.displayAssaults %}
    {% set warningText %}
      This person has been reported as the perpetrator in {{ data.newProfile.violence.numberOfAssaults }} assaults in custody before,
      including {{ data.newProfile.violence.numberOfSeriousAssaults }} serious assaults in the last 12 months
    {% endset %}
    {{ govukWarningText({
      text: warningText,
      iconFallbackText: "Warning",
      classes: "forms-warning-text warning-overrides"
    }) }}
  {% endif %}
  {% if data.newProfile.violence.notifySafetyCustodyLead %}
    {{ govukWarningText({
      text: 'Please notify your safer custody lead about this prisoner',
      iconFallbackText: "Warning",
      classes: "forms-warning-text warning-overrides"
    }) }}
 {% endif %}
{% endif %}



<h1 class="govuk-heading-m govuk-!-padding-top-7">Do you want to start their category review early?</h1>
{{ govukRadios({
  name: "confirmation",
  classes: "govuk-radios--inline",
  items: [
    {
      value: 'Yes',
      text: 'Yes, they now pose a higher risk'
    },
    {
      value: 'No',
      text: 'No, this does not justify an early review'
    }
  ]
}) }}

{% endblock %}
