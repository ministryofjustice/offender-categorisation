{% extends "../formTemplate.html" %}

{% from "warning-text/macro.njk" import govukWarningText %}
{% from "textarea/macro.njk" import govukTextarea %}

{% block formItems %}

<h1 class="govuk-heading-l">Offending history</h1>

{% include "../../partials/warningOffendingHistory.html" %}

  {% if data.offences | length %}
    <h2 class="govuk-heading-m">Previous convictions</h2>
    <div class="govuk-body-s">
      <p class="govuk-!-font-weight-bold">The following convictions are listed on NOMIS:</p>
      <ul>
        {% for offence in data.offences %}
          <li>{{ offence.offenceDescription }}{% if offence.offenceDate %}
            ({{ dateConverter(offence.offenceDate) }}{% if offence.offenceRangeDate %} - {{ dateConverter(offence.offenceRangeDate) }}{% endif %})</li>
          {% endif %}
        {% endfor %}
      </ul>
    </div>
  {% endif %}

  {{ govukTextarea({
    name: "previousConvictions",
    type: "previousConvictions",
    id: "more-detail",
    label: {
      text: "Please record a summary of previous convictions, and any other information, from this offender's PNC record, which might be relevant to their categorisation"
    },
    value: data.ratings.offendingHistory.previousConvictions,
    errorMessage: {
      text: "Please enter previous convictions"
    } if (errors | findError('previousConvictions'))
  }) }}

{% endblock %}
