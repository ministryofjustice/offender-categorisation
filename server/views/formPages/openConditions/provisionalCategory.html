{% extends "../../formPages/formTemplate.html" %}

{% from "radios/macro.njk" import govukRadios %}
{% from "details/macro.njk" import govukDetails %}

{% set cat = data.openConditionsSuggestedCat %}
{% set suggestedCat = data.categoriser.provisionalCategory.suggestedCategory if data.categoriser.provisionalCategory.suggestedCategory else data.openConditionsSuggestedCat%}
{% set overriddenCat = data.categoriser.provisionalCategory.overriddenCategory %}
{% set greenButtonText = "Submit" %}

{% set pageTitle = "Provisional category" %}

{% block navigation %}

{% if catType == 'RECAT' %}
{% include "../../partials/breadCrumbTaskListRecat.html" %}
{% else %}
{% include "../../partials/breadCrumbTaskList.html" %}
{% endif %}

{% endblock %}


{% block formItems %}

<h1 class="govuk-heading-l">{{ pageTitle }}</h1>

{% set isFemale = user.activeCaseLoad.female %}

<div class="govuk-warning-text forms-info-text warning-overrides">
  {% if (not isFemale and cat == 'D') or isFemale %}
    <span class="govuk-warning-text__icon" aria-hidden="true">!</span>
  {% else %}
    <span class="govuk-warning-text__icon" aria-hidden="true">{{ cat }}</span>
  {% endif %}
  <strong class="govuk-warning-text__text">
    <span class="govuk-warning-text__assistive">Warning</span>
    <!-- cat D/T must say open -->
    <!-- womens must say a word -->
    <!-- mens must stay be a letter -->
    {% if cat == 'D' or cat == 'T' %}
      The provisional category is open
    {% else %}
      The provisional category is {{ catHistoryMappings(cat, user.activeCaseLoad.female) }}
    {% endif %}
  </strong>
</div>
<input type="hidden" name="suggestedCategory" value="{{ suggestedCat }}" />
<input type="hidden" name="categoryAppropriate" value="{{ data.categoriser.provisionalCategory.categoryAppropriate }}" />
<input type="hidden" name="overriddenCategoryText" value="{{ data.categoriser.provisionalCategory.overriddenCategoryText }}"/>
<input type="hidden" name="overriddenCategory" value="{{ overriddenCat }}"/>
<input type="hidden" name="otherInformationText" value="{{ data.categoriser.provisionalCategory.otherInformationText }}"/>
<input type="hidden" name="openConditionsSuggestedCategory" value="{{ cat }}"/>

{% include "../../partials/warningIndeterminate.html" %}

{{ govukRadios({
  name: "openConditionsCategoryAppropriate",
  classes: "govuk-radios--inline",
  fieldset: {
    legend: {
    text: "Do you think the category is appropriate?",
    isPageHeading: false
    }
  },
  errorMessage: {
    text: "Please select yes or no"
  } if (errors | findError('openConditionsCategoryAppropriate')),
  items: [
    {
      value: "Yes",
      text: "Yes"
    },
    {
      value: "No",
      text: "No"
    }
  ]
}) }}

{% endblock %}
